{"ast":null,"code":"import _defineProperty from \"/Users/feyraf/Desktop/projet Hkos/hkos-project-front/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport AddClientBlock from \"../AddClientBlock.vue\";\n\nclass lines {\n  constructor() {\n    _defineProperty(this, \"productName\", \"\");\n\n    _defineProperty(this, \"date\", \"\");\n\n    _defineProperty(this, \"units\", \"\");\n\n    _defineProperty(this, \"quantity\", \"\");\n\n    _defineProperty(this, \"htPrice\", \"\");\n\n    _defineProperty(this, \"tvaPercent\", \"\");\n\n    _defineProperty(this, \"finalPrice\", \"\");\n  }\n\n}\n\nexport default {\n  name: \"DevisBlockGenerateur\",\n  props: {\n    msg: String\n  },\n\n  data() {\n    return {\n      status: false,\n      revele: false,\n      form: {\n        clientUuid: \"\",\n        dateReglement: \"\",\n        commentaires: \"\",\n        lines: [new lines()],\n        totalTTC: \"\",\n        totalHT: \"\",\n        totalTVA: \"\",\n        userUuid: \"7dc966c7-2a68-4a2d-b79e-407579f178c3\"\n      },\n      err: \"\"\n    };\n  },\n\n  methods: {\n    format(e) {\n      var key = e.key;\n\n      if (!/^\\d+/g.test(key) && key != \"Backspace\" && key != \"Delete\" && key != \"ArrowLeft\" && key != \"ArrowRight\") {\n        e.preventDefault();\n      }\n    },\n\n    addRow() {\n      this.form.lines.push(new lines());\n    },\n\n    async sendForm() {\n      let res = await fetch(\"https://hkos-back.herokuapp.com/devis/create\", {\n        method: \"post\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(this.form)\n      });\n      let data = await res.json();\n\n      if (data.message == \"Devis created\") {\n        this.$router.push(\"Devis\");\n      } else {\n        console.log(data);\n        this.err = data.error.message;\n      }\n    },\n\n    removeLast() {\n      this.form.lines.pop();\n    },\n\n    toggleModale: function (e) {\n      if (e) {\n        if (!e.target.closest(\".modale\") || e.target.id == \"close-btn\") this.revele = false;\n      } else this.revele = false;\n    }\n  },\n\n  mounted() {\n    this.$store.dispatch(\"getClients\");\n  },\n\n  computed: {\n    getTotal() {\n      let result = 0;\n      this.form.lines.forEach(elem => {\n        result += elem.finalPrice;\n      });\n      return result;\n    },\n\n    getHT() {\n      let result = 0;\n      this.form.lines.forEach(elem => {\n        result += elem.htPrice * elem.quantity;\n      });\n      return result;\n    },\n\n    getTVAeuro() {\n      let result = 0;\n      this.form.lines.forEach(elem => {\n        result += elem.finalPrice - elem.htPrice * elem.quantity;\n      });\n      return result;\n    },\n\n    getClients() {\n      return this.$store.state.Clients;\n    }\n\n  },\n  components: {\n    AddClientBlock\n  }\n};","map":{"version":3,"mappings":"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","names":["AddClientBlock","lines","name","props","msg","String","data","status","revele","form","clientUuid","dateReglement","commentaires","totalTTC","totalHT","totalTVA","userUuid","err","methods","format","e","key","test","preventDefault","addRow","push","sendForm","res","fetch","method","headers","body","JSON","stringify","json","message","$router","console","log","error","removeLast","pop","toggleModale","target","closest","id","mounted","$store","dispatch","computed","getTotal","result","forEach","elem","finalPrice","getHT","htPrice","quantity","getTVAeuro","getClients","state","Clients","components"],"sourceRoot":"","sources":["/Users/feyraf/Desktop/projet Hkos/hkos-project-front/src/components/user/Devis/DevisBlockGenerateur.vue"],"sourcesContent":["<template>\n  <AddClientBlock\n    @accept=\"$store.dispatch('getClients')\"\n    v-bind:revele=\"revele\"\n    v-bind:toggleModale=\"toggleModale\"\n  />\n  <div class=\"container\">\n    <div class=\"border-bottom\">\n      <span class=\"fw-normal\" style=\"font-size: 20px\">Devis</span>\n    </div>\n\n    <div class=\"pb-2 mt-3\"><span>Client</span></div>\n\n    <div class=\"input-group pb-3 border-bottom\">\n      <button\n        class=\"input-group-text\"\n        v-on:click=\"\n          $store.dispatch('toggleModal', { status: true, event: $event.target })\n        \"\n        id=\"open-modal\"\n        style=\"background-color: rgb(50, 141, 245); color: white\"\n      >\n        Nouveau client +\n      </button>\n      <select\n        class=\"form-control\"\n        style=\"font-weight: 300\"\n        v-model=\"form.clientUuid\"\n      >\n        <option value=\"\" disabled selected hidden>\n          ▾ Sélectionner un client\n        </option>\n        <option\n          :value=\"client.clientUuid\"\n          v-for=\"client in getClients\"\n          :key=\"client\"\n        >\n          {{ client.nom }} {{ client.prenoms }}\n        </option>\n      </select>\n    </div>\n\n    <div class=\"d-flex border-bottom pb-3 pt-3 row\">\n      <div class=\"w-50 col-lg\">\n        <div>\n          <label class=\"form-label\" for=\"inputDesctiption\">Commentaires</label>\n          <textarea\n            class=\"form-control\"\n            rows=\"4\"\n            v-model=\"form.commentaires\"\n          ></textarea>\n        </div>\n      </div>\n      <div class=\"w-50 col-lg\">\n        <div class=\"pb-2\">\n          <label class=\"form-label\">Date limite de réglement </label>\n          <input\n            class=\"form-control\"\n            v-model=\"form.dateReglement\"\n            type=\"date\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <div class=\"table\">\n      <div\n        class=\"t-row row mt-2\"\n        id=\"devismainblock\"\n        v-for=\"row in form.lines\"\n        :key=\"row\"\n      >\n        <div class=\"col-xl-4\" id=\"devismainblock\">\n          <label class=\"\">Description</label>\n          <input\n            class=\"form-control\"\n            v-model=\"row.productName\"\n            type=\"text\"\n            placeholder=\"Description\"\n          />\n        </div>\n        <div class=\"col\">\n          <label class=\"\">Date</label>\n          <input class=\"form-control\" v-model=\"row.date\" type=\"date\" />\n        </div>\n\n        <div class=\"col\">\n          <label class=\"\">Quantité</label>\n          <input\n            class=\"form-control calc-inp maclasse\"\n            v-model=\"row.quantity\"\n            @keydown=\"format\"\n            placeholder=\"Quantité\"\n            type=\"number\"\n            step=\"1.0\"\n          />\n        </div>\n\n        <div class=\"col\">\n          <label class=\"\">Unité</label>\n          <select class=\"form-control\" type=\"\" v-model=\"row.units\">\n            <option value=\"PIECE\">Piéce(s)</option>\n            <option value=\"HEURE\">Heures</option>\n            <option value=\"KM\">Km</option>\n            <option value=\"KG\">Kg</option>\n            <option value=\"M\">M</option>\n            <option value=\"LOT_PARC\">Lot Parc</option>\n            <option value=\"AM\">Am</option>\n          </select>\n        </div>\n\n        <div class=\"col\">\n          <label class=\"\">Prix(€)</label>\n          <input\n            class=\"form-control calc-inp\"\n            type=\"number\"\n            placeholder=\"Prix\"\n            v-model=\"row.htPrice\"\n          />\n        </div>\n        <div class=\"col\">\n          <label class=\"\">TVA(%)</label>\n          <input\n            class=\"form-control calc-inp\"\n            type=\"number\"\n            v-model=\"row.tvaPercent\"\n            @keydown=\"format\"\n            placeholder=\"TVA(%)\"\n            step=\"1\"\n          />\n        </div>\n\n        <div class=\"col\">\n          <label class=\"\">Montant(€)</label>\n          <input\n            class=\"form-control\"\n            type=\"points\"\n            :value=\"\n              (row.finalPrice =\n                row.quantity *\n                row.htPrice *\n                (1 + row.tvaPercent / 100)).toFixed(0)\n            \"\n            placeholder=\"0.00\"\n            step=\"0.1\"\n            readonly=\"readonly\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"mx-auto d-flex justify-content-between\">\n      <div>\n        <button class=\"btn btn-light border mt-3\" type=\"button\" @click=\"addRow\">\n          Ajouter +\n        </button>\n      </div>\n\n      <div>\n        <button\n          v-if=\"form.lines.length > 1\"\n          @click=\"removeLast\"\n          class=\"btn btn-light border mt-3\"\n        >\n          Supprimer -\n        </button>\n      </div>\n    </div>\n\n    <div>\n      <label class=\"mt-3 me-2\">Total HT(€)</label>\n      <input\n        style=\"border: none\"\n        type=\"number\"\n        placeholder=\"0.00\"\n        readonly=\"readonly\"\n        :value=\"(form.totalHT = getHT.toFixed(0))\"\n      />\n    </div>\n    <div>\n      <label class=\"mt-3 me-2\">Total TVA(€)</label>\n      <input\n        style=\"border: none\"\n        type=\"number\"\n        placeholder=\"0.00\"\n        readonly=\"readonly\"\n        :value=\"(form.totalTVA = getTVAeuro.toFixed(0))\"\n      />\n    </div>\n    <div>\n      <label class=\"mt-3 me-2\">Total TTC</label>\n      <input\n        style=\"border: none\"\n        type=\"number\"\n        placeholder=\"0.00\"\n        readonly=\"readonly\"\n        :value=\"(form.totalTTC = getTotal.toFixed(0))\"\n      />\n    </div>\n  </div>\n  <div id=\"notify\" class=\"text-danger\">{{ err }}</div>\n  \n  <div class=\"d-flex justify-content-center m-4\">\n    <button class=\"btnHkos\" @click=\"sendForm\">Générer mon devis</button>\n  </div>\n</template>\n\n<script>\nimport AddClientBlock from \"../AddClientBlock.vue\";\n\nclass lines {\n  productName = \"\";\n  date = \"\";\n  units = \"\";\n  quantity = \"\";\n  htPrice = \"\";\n  tvaPercent = \"\";\n  finalPrice = \"\";\n}\n\nexport default {\n  name: \"DevisBlockGenerateur\",\n  props: {\n    msg: String,\n  },\n\n  data() {\n    return {\n      status: false,\n      revele: false,\n      form: {\n        clientUuid: \"\",\n        dateReglement: \"\",\n        commentaires: \"\",\n        lines: [new lines()],\n        totalTTC: \"\",\n        totalHT: \"\",\n        totalTVA: \"\",\n        userUuid: \"7dc966c7-2a68-4a2d-b79e-407579f178c3\",\n      },\n      err: \"\",\n    };\n  },\n  methods: {\n    format(e) {\n      var key = e.key;\n      if (\n        !/^\\d+/g.test(key) &&\n        key != \"Backspace\" &&\n        key != \"Delete\" &&\n        key != \"ArrowLeft\" &&\n        key != \"ArrowRight\"\n      ) {\n        e.preventDefault();\n      }\n    },\n    addRow() {\n      this.form.lines.push(new lines());\n    },\n    async sendForm() {\n      let res = await fetch(\"https://hkos-back.herokuapp.com/devis/create\", {\n        method: \"post\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(this.form),\n      });\n\n      let data = await res.json();\n\n      if (data.message == \"Devis created\") {\n        this.$router.push(\"Devis\");\n      } else {\n        console.log(data);\n        this.err = data.error.message;\n      }\n    },\n\n    removeLast() {\n      this.form.lines.pop();\n    },\n\n    toggleModale: function (e) {\n      if (e) {\n        if (!e.target.closest(\".modale\") || e.target.id == \"close-btn\")\n          this.revele = false;\n      } else this.revele = false;\n    },\n  },\n  mounted() {\n    this.$store.dispatch(\"getClients\");\n  },\n\n  computed: {\n    getTotal() {\n      let result = 0;\n      this.form.lines.forEach((elem) => {\n        result += elem.finalPrice;\n      });\n      return result;\n    },\n\n    getHT() {\n      let result = 0;\n      this.form.lines.forEach((elem) => {\n        result += elem.htPrice * elem.quantity;\n      });\n      return result;\n    },\n    getTVAeuro() {\n      let result = 0;\n      this.form.lines.forEach((elem) => {\n        result += elem.finalPrice - elem.htPrice * elem.quantity;\n      });\n      return result;\n    },\n\n    getClients() {\n      return this.$store.state.Clients;\n    },\n  },\n  components: {\n    AddClientBlock,\n  },\n};\n</script>\n<style scoped>\n* {\n  font-size: 14px;\n}\n</style>\n\n"]},"metadata":{},"sourceType":"module"}